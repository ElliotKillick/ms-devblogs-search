


	
        What defines an old-style common dialog?          Raymond Chen        
            
            September 17th, 20180 0
		
        In the documentation for the OPENÂ­FILEÂ­NAME structure, there are many references to â€œold-styleâ€ dialogs. What is an old-style dialog, how do you get one, and how is it different from a new-style dialog?
So-called â€œold-styleâ€ dialogs are the File Open and File Save dialogs from Windows 3.1. Hereâ€™s roughly what they looked like:




Open






File name:

Folders:



OK

Â 

Cancel


Â 


Â 


file.txt


Â 
C:\WINDOWS
Â 





Â 


CONFIG.TXT
DISPLAY.TXT
EXCHANGE.TXT
EXTRA.TXT
FAQ.TXT
GENERAL.TXT


â–´


Â 

Â 

â–¾




Â 


ğŸ“ C:\
Â ğŸ“ WINDOWS
Â Â ğŸ“COMMAND
Â Â ğŸ“CONFIG
Â Â ğŸ“CURSORS
Â Â ğŸ“Desktop


â–´


Â 

Â 

â–¾




Â 





Â 
List files of type:
Â 
Drives:
Â 
Â 





Â 


Text files (*.txt)

â–¾



Â 


ğŸ–´ C:

â–¾



Â 







These are not the â€œnewâ€ style dialogs that resemble an Explorer window. They are the old-fashioned dialogs that scream â€œI was written in the early 1990s!â€
When you use an old-style dialog, Windows basically uses the code that was originally written for Windows 3.1, because programs from that era donâ€™t support fancy things like long file names, and when they try to customize the dialog, they are expecting to customize a Windows 3.1-style dialog, so thatâ€™s what we give them.
Here are the main differences between the old style and new style dialogs:



Feature
Old-style
New-style


Long file names
No
Yes


Resizability
Not resizable
Resizable


Multiselect
Space-separated file names
Null-separated file names


Template
Replaces entire dialog
Embedded into existing dialog


Default extension
Maximum 3 characters
Can exceed 3 characters


Hooks
Windows 3.1-style
Windows 95-style



The system decides whether you get an old-style or new-style dialog based on the following rules:

If you say OFN_EXPLORER, then you get a new-style dialog.
If you donâ€™t say OFN_EXPLORER, and you do say OFN_ENABLEÂ­TEMPLATE, OFN_ENABLEÂ­TEMPLATEÂ­HANDLE, OFN_ENABLEÂ­HOOK, or OFN_ALLOWÂ­MULTIÂ­SELECT, then you get an old-style dialog.
If you donâ€™t say anything on the above list, then you get a new-style dialog.

In words: You get an old-style dialog if you ask for any of OFN_ENABLEÂ­TEMPLATE, OFN_ENABLEÂ­TEMPLATEÂ­HANDLE, OFN_ENABLEÂ­HOOK, or OFN_ALLOWÂ­MULTIÂ­SELECT, since those are the things that affect the programmatic behavior of the dialog. However, you can override this by saying OFN_EXPLORER to say, â€œNo really, Iâ€™m okay with the new hotness.â€

        
                

        
		
                

            
            
                
                    Raymond Chen                
                
            
            

                
        
            Follow 
          
                
            
        
                
            
    
   

        

            

            
       
        
	




	

		Tagged Code
	

