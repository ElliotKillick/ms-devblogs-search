Nick  September 10, 2019


  0  Collapse this comment
Copy link
Canâ€™t you get away with skipping the underscore to space step?Â  Some quick testing seems to show that ToTitleCase will also treat underscores as word separators:
(Get-Culture).TextInfo.ToTitleCase($t.ToLower()).Replace(â€œ_â€,â€â€)
seems to work correctly.Â  Is there a corner case Iâ€™m missing?
Also, â€œshouty snake caseâ€ is a new favorite; though it seems like the alternative should then be â€œsneaky snake caseâ€.





Raymond Chen Author
September 10, 2019


  0  Collapse this comment
Copy link
Awesome! Underscore is a â€œpunctuation connectorâ€ which ToTitleCase treats as a word separator, so this works.




Mystery Man  September 10, 2019


  0  Collapse this comment
Copy link
Regex was my first thought.





Sacha Roscoe  September 10, 2019


  0  Collapse this comment
Copy link
Are there any potential issues here with culture settings? How do ToLower and ToTitleCase interact in other cultures? Are we going to muck up the Turkish i and/or Ä±, as we so often like to do?





Andrew Cook  September 10, 2019


  0  Collapse this comment
Copy link
`ToTitleCase` internally uses `ToLower` and `ToUpper` as needed, so it has the same cultural implications as the other two examples. The documentation calls out that *currently* it uses naÃ¯ve English casing rules only, but reserves the right to use culture-specific ones in the future.
`ToTitleCase` gives different results than the other two, however, if there are any embedded non-alphanumerics in the string.
Read more`ToTitleCase` internally uses `ToLower` and `ToUpper` as needed, so it has the same cultural implications as the other two examples. The documentation calls out that *currently* it uses naÃ¯ve English casing rules only, but reserves the right to use culture-specific ones in the future.
`ToTitleCase` gives different results than the other two, however, if there are any embedded non-alphanumerics in the string.
Read less







cheong00  September 10, 2019


  0  Collapse this comment
Copy link
And if your script plans to run on systems that may have other culture, I think you can use System.Globalization.CultureInfo.InvariantCulture instead of Get-Culture



cheong00  September 9, 2019


  0  Collapse this comment
Copy link
Hereâ€™s one case where using RegEx is actually better.





John Wiltshire  September 9, 2019


  0  Collapse this comment
Copy link
The real question is whether you can do it with cmd.exe!





David Streeter  September 9, 2019


  0  Collapse this comment
Copy link
@ECHO OFF
SET t=SHOUTY_SNAKE_CASE
FOR %%i IN ("A=a" "B=b" "C=c" "D=d" "E=e" "F=f" "G=g" "H=h" "I=i" "J=j" "K=k" "L=l" "M=m" "N=n" "O=o" "P=p" "Q=q" "R=r" "S=s" "T=t" "U=u" "V=v" "W=w" "X=x" "Y=y" "Z=z") DO CALL SET "t=%%t:%%~i%%"
SET t1=%t:~0,1%
FOR %%i IN ("a=A" "b=B" "c=C" "d=D" "e=E" "f=F" "g=G" "h=H" "i=I" "j=J" "k=K" "l=L" "m=M" "n=N" "o=O" "p=P" "q=Q" "r=R" "s=S" "t=T" "u=U" "v=V" "w=W" "x=X" "y=Y" "z=Z") DO CALL SET "t1=%%t1:%%~i%%"
SET t2=%t:~1%
SET...Read more@ECHO OFF
SET t=SHOUTY_SNAKE_CASE
FOR %%i IN (â€œA=aâ€ â€œB=bâ€ â€œC=câ€ â€œD=dâ€ â€œE=eâ€ â€œF=fâ€ â€œG=gâ€ â€œH=hâ€ â€œI=iâ€ â€œJ=jâ€ â€œK=kâ€ â€œL=lâ€ â€œM=mâ€ â€œN=nâ€ â€œO=oâ€ â€œP=pâ€ â€œQ=qâ€ â€œR=râ€ â€œS=sâ€ â€œT=tâ€ â€œU=uâ€ â€œV=vâ€ â€œW=wâ€ â€œX=xâ€ â€œY=yâ€ â€œZ=zâ€) DO CALL SET â€œt=%%t:%%~i%%â€
SET t1=%t:~0,1%
FOR %%i IN (â€œa=Aâ€ â€œb=Bâ€ â€œc=Câ€ â€œd=Dâ€ â€œe=Eâ€ â€œf=Fâ€ â€œg=Gâ€ â€œh=Hâ€ â€œi=Iâ€ â€œj=Jâ€ â€œk=Kâ€ â€œl=Lâ€ â€œm=Mâ€ â€œn=Nâ€ â€œo=Oâ€ â€œp=Pâ€ â€œq=Qâ€ â€œr=Râ€ â€œs=Sâ€ â€œt=Tâ€ â€œu=Uâ€ â€œv=Vâ€ â€œw=Wâ€ â€œx=Xâ€ â€œy=Yâ€ â€œz=Zâ€) DO CALL SET â€œt1=%%t1:%%~i%%â€
SET t2=%t:~1%
SET t2=%t2:_= %
FOR %%i IN (â€ a= Aâ€ â€ b= Bâ€ â€ c= Câ€ â€ d= Dâ€ â€ e= Eâ€ â€ f= Fâ€ â€ g= Gâ€ â€ h= Hâ€ â€ i= Iâ€ â€ j= Jâ€ â€ k= Kâ€ â€ l= Lâ€ â€ m= Mâ€ â€ n= Nâ€ â€ o= Oâ€ â€ p= Pâ€ â€ q= Qâ€ â€ r= Râ€ â€ s= Sâ€ â€ t= Tâ€ â€ u= Uâ€ â€ v= Vâ€ â€ w= Wâ€ â€ x= Xâ€ â€ y= Yâ€ â€ z= Zâ€) DO CALL SET â€œt2=%%t2:%%~i%%â€
SET t=%t1%%t2%
SET t=%t: =%
ECHO %t%
Read less







Neil Rashbrook  September 10, 2019


  0  Collapse this comment
Copy link
Overkill. Try this:
@set t=_%1
@for %%l in (a b c d e f g h i j k l m n o p q r s t u v w x y z)do @call set t=%%t:%%l=%%l%%
@for %%l in (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z)do @call set t=%%t:_%%l=%%l%%
@echo %t%
Edit: the formatting looked...Read moreOverkill. Try this:
@set t=_%1
@for %%l in (a b c d e f g h i j k l m n o p q r s t u v w x y z)do @call set t=%%t:%%l=%%l%%
@for %%l in (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z)do @call set t=%%t:_%%l=%%l%%
@echo %t%
Edit: the formatting looked OK (i.e. like Pauloâ€™s) when I posted itâ€¦
Read less






Me Gusta  September 9, 2019


  0  Collapse this comment
Copy link
Well, you can run powershell.exe from cmd.exe, so given this post, I would imagine something based around powershell.exe -Command.




Paulo Morgado  September 9, 2019


  0  Collapse this comment
Copy link
$uc = $true;
[string]::new(($t.ToCharArray() | % {
  if ($uc) { [CultureInfo]::CurrentCulture.TextInfo.ToUpper($_); $uc = $false; }
  elseif ($_ -eq '_') { $uc = $true}
  else { [CultureInfo]::CurrentCulture.TextInfo.ToLower($_); }
}))





Petri Oksanen  September 9, 2019


  0  Collapse this comment
Copy link
Kids today with their fancy PowerShell, am I right? ğŸ™‚
perl -wnle â€œmy$l;for(splitâ€™_â€™){$l.=ucfirst lc}print$lâ€





Raymond Chen Author
September 9, 2019


  0  Collapse this comment
Copy link
If youâ€™re going to go perl, you may as well go all the way: perl -ne â€œfor(split _){print ucfirst lc}â€. But that requires the snake_case to be passed as stdin rather than on the command line. perl -e â€œfor(split _,shift){print ucfirst lc}â€ takes it from the command line.





Petri Oksanen  September 9, 2019


  0  Collapse this comment
Copy link
Iâ€™m assuming the data is from the stdin or from the contents of a file provided as argument. ğŸ™‚
I wonder if this can be beat: perl -ne â€œprint ucfirst lc for split _â€